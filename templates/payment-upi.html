{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>UPI Payment</title>

<link rel="stylesheet" href="{% static 'css/payment-upi.css' %}" />
</head>
<body>
<h2>Scan & Pay Using UPI</h2>

<div class="main-box">
  <div class="qr-wrapper">

    <!-- ✅ DYNAMIC UPI QR (FROM DJANGO VIEW) -->
    <img
      src="data:image/png;base64,{{ qr_code }}"
      class="qr img"
      alt="QR Code (scan to pay)"
      width="320"
      height="320"
    >

    <div class="upi-info" style="margin-top:10px;">
      UPI ID: <strong>{{ upi_id }}</strong>
    </div>

    <div class="payment-summary" style="margin-top:14px; text-align:center;">
      <div style="font-weight:600;">Amount to Pay</div>
      <div style="font-size:22px; color:#0b8; font-weight:700;">
        ₹{{ amount }}
      </div>
      <div style="font-size:12px; color:#bbb; margin-top:6px;">
        (If amount doesn't auto-fill in your UPI app, please enter this amount manually.)
      </div>
    </div>

  </div>
</div>


  <div class="timer" style="margin-top:18px; text-align:center;">
    Time Left: <span id="countdown">05:00</span>
  </div>

  <div class="instructions" style="margin-top:18px;">
    <p>✔ Open PhonePe, Google Pay, Paytm or any UPI App</p>
    <p>✔ Scan the QR Code above</p>
    <p>✔ Confirm the amount <em>(should auto-fill if QR contained the amount)</em> and complete the payment</p>
    <p>✔ After payment, click the button below so we can verify and complete your order</p>
  </div>

  <div style="text-align:center; margin-top:14px;">
    <button class="btn" onclick="confirmPayment()">I Have Paid</button>
  </div>

  <div id="processing" style="display:none; margin-top:12px; text-align:center;">
    <div class="loader" style="display:inline-block; width:22px; height:22px; border:3px solid #ccc; border-top-color:#0b8; border-radius:50%; animation:spin 1s linear infinite;"></div>
    <div style="display:inline-block; margin-left:8px; vertical-align:middle;">Verifying your payment...</div>
  </div>

</div>

<script src="{% static 'js/payment-upi.js' %}"></script>

<div class="back-btn" onclick="window.location.href='{% url 'payment' %}'">← Back</div>

<style>
/* small inline helpers so page looks ok if your css not loaded */
.main-box{max-width:760px;margin:18px auto;padding:20px;border-radius:12px;background:linear-gradient(180deg,#07192b,#021427);color:#fff}
.qr-wrapper{display:flex;flex-direction:column;align-items:center;justify-content:center}
.qr-img{background:#fff;padding:8px;border-radius:10px}
.upi-info{margin-top:8px;color:#aee}
.instructions p{margin:6px 0;color:#cde}
.btn{background:linear-gradient(90deg,#06b6d4,#0ea5a7);border:none;color:#fff;padding:12px 28px;border-radius:10px;font-weight:600;cursor:pointer}
.back-btn{position:fixed;right:18px;bottom:18px;background:rgba(0,0,0,0.35);color:#0ff;padding:8px 12px;border-radius:20px;cursor:pointer}
@keyframes spin{to{transform:rotate(360deg)}}
</style>

</body>
</html>
