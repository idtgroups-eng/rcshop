{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UPI Payment - RCShop</title>
<link rel="stylesheet" href="{% static 'css/payment-upi.css' %}">
<style>
.proof-upload-box{
  margin-top:25px;
  padding:18px;
  background:rgba(255,255,255,.1);
  border-radius:16px;
  text-align:center;
}
.proof-upload-box h3{color:#fff;margin-bottom:8px}
.proof-upload-box input{color:#fff;margin:10px 0}
.upload-btn{
  background:linear-gradient(135deg,#00f0ff,#007bff);
  border:none;
  color:#fff;
  padding:12px 32px;
  border-radius:30px;
  font-weight:700;
  cursor:pointer;
}
</style>
</head>
<body>

<h2 class="title">Complete Your Payment</h2>

<div class="main-box">

  <div class="qr-wrapper">
    <img src="data:image/png;base64,{{ qr_code }}" class="qr-img" width="260">
    <div class="upi-id">UPI ID: <b>{{ upi_id }}</b></div>

    <div class="amount-box">
      ₹{{ amount }}
      <small>Pay exactly this amount</small>
    </div>

    <!-- AUTO OPEN ALL UPI APPS -->
    <a id="upiIntentBtn" class="upi-btn">
      Pay via PhonePe / Google Pay / Paytm
    </a>
  </div>

  <div class="timer">
    Checking payment in <span id="countdown">05:00</span>
  </div>

  <div class="instructions">
    <p>✔ Click above button or scan QR</p>
    <p>✔ Complete payment in your UPI App</p>
    <p>✔ Upload screenshot below after payment</p>
  </div>

  <!-- ================= UPLOAD PAYMENT PROOF ================= -->
  <div class="proof-upload-box">
    <h3>Upload Payment Screenshot</h3>
    <form method="POST" enctype="multipart/form-data" action="{% url 'upload_payment_proof' %}">
      {% csrf_token %}
      <input type="file" name="screenshot" required>
      <button type="submit" class="upload-btn">
        Submit Payment Proof
      </button>
    </form>
  </div>

  <div id="processing" style="display:none;text-align:center;margin-top:12px;">
    <div class="loader"></div>
    <div style="margin-top:6px;">Verifying your payment securely...</div>
  </div>

</div>

<script>
const upiURL = "{{ upi_url }}";
document.getElementById("upiIntentBtn").href = upiURL;
</script>

</body>
</html>
